version: 2.1

orbs:
  node: circleci/node@5.1.0
  ruby: circleci/ruby@2.1.2
  aws-cli: circleci/aws-cli@3.1.5

jobs:           
  # iOS Build
  ios:
    macos:
      xcode: 15.0.1
    steps:
      - checkout
      - run:
          command: ls -lah
#************************************************************************************************
      # Node modules with caching 
      - node/install:
          node-version: '20.9.0' 
      # - ruby/install:
      #     version: '2.7.5'
      #cococapods install (3.0.5) after ruby 
      - run:
          name: check v
          command: |
            node -v
            ruby -v
      - run:
          name: Install dependencies bundle
          command: |
            bundle install
            gem uninstall activesupport --y 
            gem install activesupport --version 7.0.8
            
      # Installing Fastlane
      - run:
          name: install fastlane 
          command: gem install fastlane 
      - run: 
          name: node modules check
          command: |
            npm install
            ls -l

      - run: 
          name: pod install
          command: |
            cd ios && pod install
      
#******************************************************************************************


workflows:
  build_and_test:
    jobs:
      - ios
